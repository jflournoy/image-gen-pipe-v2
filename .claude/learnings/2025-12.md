# Learnings - 2025-12

## 2025-12-09 - 21:46
Ensemble voting with dimensional ties: Allowing both images to receive rank=1 on individual dimensions (alignment/aesthetics) is sound design. It provides more fidelity than forcing artificial winners. The ensemble + weighting system handles ties well—ties on one dimension are overcome by strong signal on others, preventing noise injection. Per-dimension averaging first (before combining) properly weights each factor's contribution.

## 2025-12-10 - 08:04
Token Tracking Verification Complete: Image generation dominates beam search costs (99%), making it primary optimization target. All 11 API calls tracked with automatic cost estimation. Key lesson: generic fallback pricing must be defined (image: 0.04) for cost calculations to work. Documentation-first verification approach enabled 100% coverage confirmation.

## 2025-12-13 - 21:10
Safety retry pattern: When implementing auto-retry for content policy violations, the LLM that rephrases the prompt may also refuse. Added generateText() method to LLM providers for general text generation, and improved error messages to distinguish between LLM refusal vs other errors. Per-candidate error recovery ensures job continues even when some candidates fail.

## 2025-12-13 - 21:10
Linked dropdowns UX: For beam search config, replaced single N×M dropdown with two linked dropdowns - beam width populates keep-top with valid divisors. This prevents invalid configurations and shows expansion ratio (children/parent) for each option.

